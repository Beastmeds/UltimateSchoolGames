<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate School Games</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  body { font-family:'Roboto',sans-serif; margin:0; padding:0; background:#f0f0f0; color:#000; text-align:center; }
  .menu, .settings, .game, #adminPanel { display:none; padding:20px; max-width:600px; margin:auto; }
  .visible { display:block; }
  button { padding:10px 20px; margin:5px; border:none; border-radius:8px; cursor:pointer; background:linear-gradient(45deg,#6a11cb,#2575fc); color:white; font-weight:bold; transition:0.3s; }
  button:hover { transform: scale(1.05); box-shadow:0 0 10px #2575fc; }
  input { padding:8px; margin:5px; border-radius:5px; border:1px solid #ccc; width:calc(100% - 20px); }
  #gameArea { width:100%; height:200px; margin:20px 0; position:relative; overflow:hidden; background:#a0e0ff; border-radius:12px; }
  #player { width:50px; position:absolute; bottom:0px; left:50px; }
  .bg-image { width:100%; height:150px; object-fit:cover; border-radius:10px; margin-bottom:10px; }
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.31.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.31.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.31.0/firebase-firestore-compat.js"></script>
</head>
<body>

<!-- MENU -->
<div class="menu visible" id="menu">
  <h1>Ultimate School Games</h1>
  <button onclick="startClicker()">ğŸ« Clicker</button>
  <button onclick="startRunner()">ğŸƒ Runner</button>
  <button onclick="openSettings()">âš™ Einstellungen</button>
  <button id="adminBtn" onclick="showAdminPanel()" style="display:none;">ğŸ‘‘ Admin Dashboard</button>
</div>

<!-- CLICKER -->
<div class="game" id="clickerGame">
  <h2>School Clicker</h2>
  <p>Klicks: <span id="clickCount">0</span></p>
  <button onclick="clickerClick()">Klick mich!</button>
  <button onclick="backToMenu()">ğŸ”™ Menu</button>
</div>

<!-- RUNNER -->
<div class="game" id="runnerGame">
  <h2>School Runner</h2>
  <p>Level: <span id="runnerLevel">1</span> | XP: <span id="runnerXP">0</span></p>
  <div id="gameArea">
    <img src="https://i.imgur.com/2yaf2wb.jpeg" id="player">
  </div>
  <button onclick="jump()">Sprung</button>
  <button onclick="backToMenu()">ğŸ”™ Menu</button>
</div>

<!-- SETTINGS -->
<div class="settings" id="settingsMenu">
  <h2>âš™ Einstellungen</h2>
  <div>
    <h4>ğŸµ Musik LautstÃ¤rke</h4>
    <input type="range" id="musicVolume" min="0" max="1" step="0.01" value="0.5" onchange="setVolume(this.value)">
  </div>
  <div>
    <h4>ğŸ­ Skin auswÃ¤hlen</h4>
    <button onclick="changeSkin('schueler')">SchÃ¼ler</button>
    <button onclick="changeSkin('lehrer')">Lehrer</button>
    <button onclick="changeSkin('direktor')">Direktor</button>
    <button onclick="changeSkin('ninja')">Ninja</button>
  </div>
  <div>
    <h4>ğŸ–¼ Hintergrund</h4>
    <button onclick="changeBG('school')">Schule</button>
    <button onclick="changeBG('funny')">Meme</button>
    <button onclick="changeBG('gaming')">Gaming</button>
  </div>
  <div>
    <h4>ğŸ” Konto</h4>
    <input id="emailInput" type="email" placeholder="Email">
    <input id="passwordInput" type="password" placeholder="Passwort">
    <button onclick="registerUser()">Registrieren</button>
    <button onclick="loginUser()">Login</button>
    <button onclick="logoutUser()">Logout</button>
  </div>
  <div>
    <h4>ğŸ’¾ Spielstand</h4>
    <button onclick="exportSave()">Export</button>
    <button onclick="importSave()">Import</button>
  </div>
  <button onclick="backToMenu()">ğŸ”™ Menu</button>
</div>

<!-- ADMIN -->
<div class="settings" id="adminPanel">
  <h2>ğŸ‘‘ Admin Dashboard</h2>
  <div>
    <h4>ğŸ­ Skins freischalten</h4>
    <button onclick="unlockSkin('schueler')">SchÃ¼ler</button>
    <button onclick="unlockSkin('lehrer')">Lehrer</button>
    <button onclick="unlockSkin('direktor')">Direktor</button>
    <button onclick="unlockSkin('ninja')">Ninja</button>
  </div>
  <div>
    <h4>ğŸ’¥ Extras</h4>
    <button onclick="addClicks(1000)">+1000 Klicks</button>
    <button onclick="resetAllGames()">SpielstÃ¤nde zurÃ¼cksetzen</button>
  </div>
  <button onclick="backToMenu()">ğŸ”™ Menu</button>
</div>

<script>
/* -------------------------
       GLOBAL STATE
------------------------- */
let state = {
  count:0,
  multiplier:1,
  level:1,
  xp:0,
  skin:'schueler',
  bgPack:'school',
  loggedInUser:null,
  isAdmin:false
};

/* -------------------------
      MENU FUNCTIONS
------------------------- */
function startClicker(){ showGame('clickerGame'); updateDisplay(); }
function startRunner(){ showGame('runnerGame'); updateDisplay(); }
function openSettings(){ showGame('settingsMenu'); }
function backToMenu(){ document.querySelectorAll('.game, .settings').forEach(g=>g.classList.remove('visible')); document.getElementById('menu').classList.add('visible'); }
function showGame(id){ document.querySelectorAll('.game, .settings').forEach(g=>g.classList.remove('visible')); document.getElementById(id).classList.add('visible'); }

/* -------------------------
      CLICKER FUNCTIONS
------------------------- */
function clickerClick(){ state.count+=state.multiplier; updateDisplay(); saveGameToCloud(); }

/* -------------------------
      RUNNER FUNCTIONS
------------------------- */
let isJumping=false;
function jump(){
  if(isJumping) return;
  isJumping=true;
  const player=document.getElementById('player');
  let pos=0;
  let up=setInterval(()=>{ if(pos>=100){ clearInterval(up); down(); } else { pos+=10; player.style.bottom=pos+'px'; } },50);
  function down(){ let downInt=setInterval(()=>{ if(pos<=0){ clearInterval(downInt); player.style.bottom='0px'; isJumping=false; } else { pos-=10; player.style.bottom=pos+'px'; } },50);}
}

/* -------------------------
      SETTINGS FUNCTIONS
------------------------- */
function setVolume(v){ console.log('Volume',v); }
function changeSkin(s){ state.skin=s; alert('Skin geÃ¤ndert: '+s); saveGameToCloud(); updateDisplay(); }
function changeBG(bg){ state.bgPack=bg; alert('Hintergrund geÃ¤ndert'); saveGameToCloud(); }

/* -------------------------
     EXPORT / IMPORT
------------------------- */
function exportSave(){ const blob=new Blob([JSON.stringify(state)],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='save.json'; a.click(); }
function importSave(){ const input=document.createElement('input'); input.type='file'; input.accept='.json'; input.onchange=e=>{ const file=e.target.files[0]; const reader=new FileReader(); reader.onload=e=>{ Object.assign(state, JSON.parse(e.target.result)); updateDisplay(); alert('Spielstand geladen!'); }; reader.readAsText(file); }; input.click(); }

/* -------------------------
       UPDATE DISPLAY
------------------------- */
function updateDisplay(){ document.getElementById('clickCount').textContent=state.count; document.getElementById('runnerLevel').textContent=state.level; document.getElementById('runnerXP').textContent=state.xp; }

/* -------------------------
       FIREBASE SETUP
------------------------- */
const firebaseConfig = {
  apiKey: "AIzaSyDBauKzilu4O3hH68Aq0c1F5AykhAg3Db4",
  authDomain: "ultimate-school-games.firebaseapp.com",
  projectId: "ultimate-school-games",
  storageBucket: "ultimate-school-games.firebasestorage.app",
  messagingSenderId: "870332221562",
  appId: "1:870332221562:web:da450674b44bbfa18513c3",
  measurementId: "G-F8MFSLNWVB"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

/* -------------------------
       USER AUTH
------------------------- */
function registerUser(){
  const email=document.getElementById('emailInput').value;
  const password=document.getElementById('passwordInput').value;
  auth.createUserWithEmailAndPassword(email,password)
    .then(u=>{ state.loggedInUser=u.user.uid; alert('âœ… Registriert!'); saveGameToCloud(); checkAdmin(email); })
    .catch(e=>alert('âŒ '+e.message));
}
function loginUser(){
  const email=document.getElementById('emailInput').value;
  const password=document.getElementById('passwordInput').value;
  auth.signInWithEmailAndPassword(email,password)
    .then(u=>{ state.loggedInUser=u.user.uid; alert('âœ… Eingeloggt!'); loadGameFromCloud(); checkAdmin(email); })
    .catch(e=>alert('âŒ '+e.message));
}
function logoutUser(){ auth.signOut().then(()=>{ state.loggedInUser=null; state.isAdmin=false; document.getElementById('adminBtn').style.display='none'; alert('ğŸ”“ Ausgeloggt'); }); }

/* -------------------------
       CLOUD SAVE
------------------------- */
function saveGameToCloud(){ if(!state.loggedInUser) return; db.collection('users').doc(state.loggedInUser).set(state).then(()=>console.log('âœ” Cloud Save')).catch(e=>console.error(e)); }
function loadGameFromCloud(){ if(!state.loggedInUser) return; db.collection('users').doc(state.loggedInUser).get().then(doc=>{ if(doc.exists){ Object.assign(state,doc.data()); updateDisplay(); alert('âœ… Cloud geladen'); } else alert('â„¹ Kein Cloud Spielstand'); }).catch(e=>console.error(e)); }

/* -------------------------
       ADMIN FEATURES
------------------------- */
function checkAdmin(email){
  if(email==='admin@example.com'){ state.isAdmin=true; document.getElementById('adminBtn').style.display='inline-block'; alert('ğŸ‘‘ Admin erkannt'); }
  else{ state.isAdmin=false; document.getElementById('adminBtn').style.display='none'; }
}
function showAdminPanel(){ if(!state.isAdmin){ alert('âŒ Kein Admin'); return;} showGame('adminPanel'); }
function unlockSkin(skin){ changeSkin(skin); alert('Skin freigeschaltet: '+skin); }
function addClicks(amount){ state.count+=amount; updateDisplay(); saveGameToCloud(); alert('âœ… '+amount+' Klicks hinzugefÃ¼gt'); }
function resetAllGames(){ if(confirm('âš ï¸ Alle SpielstÃ¤nde zurÃ¼cksetzen?')){ localStorage.clear(); state.count=0; state.level=1; state.xp=0; state.multiplier=1; updateDisplay(); saveGameToCloud(); alert('âœ… ZurÃ¼ckgesetzt'); } }

</script>

</body>
</html>
